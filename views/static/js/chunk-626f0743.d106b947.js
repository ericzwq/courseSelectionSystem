(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-626f0743"],{"0680":function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var a=[{name:"请选择",value:""},{name:"特优(90以上)",value:0},{name:"优(80-89)",value:1},{name:"良(70-79)",value:2},{name:"及格(60-69)",value:3},{name:"不及格(60以下)",value:4},{name:"无成绩",value:5}]},"1c78":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("my-layout",{attrs:{formCollapse:e.formCollapse},scopedSlots:e._u([{key:"tableLayout",fn:function(t){return[o("my-table",{ref:"table",attrs:{tableData:e.tableData,height:t.height,totalCount:e.totalCount},on:{getData:e.getTable,"selection-change":e.selectChange}},[o("template",{slot:"tableHead"},[o("el-table-column",{attrs:{type:"selection"}}),o("el-table-column",{attrs:{type:"index",index:e.computeIndex,label:"序号",width:"60","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"studentName",label:"学生名","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"studentId",label:"学号","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"courseName",label:"课程名","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"courseId",label:"课程号","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"teacherName",label:"教师名","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"teacherId",label:"教师号","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"分数","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(-1===t.row.score?"暂无":t.row.score))])]}}],null,!0)}),o("el-table-column",{attrs:{prop:"classTime",label:"开课时间","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"updatedBy",label:"修改人","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"createdAt",label:"创建时间","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"updatedAt",label:"修改时间","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(o){return e.updateScore(t.row)}}},[e._v("修改")])]}}],null,!0)},[e._v(' label="操作"> ')])],1)],2)]}}])},[o("el-form",{ref:"searchForm",staticClass:"search_form",attrs:{slot:"form",inline:!0,size:"mini",model:e.searchForm},slot:"form"},[o("el-form-item",{attrs:{label:"学生名",prop:"studentName"}},[o("el-input",{attrs:{placeholder:"请输入学生名",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.searchForm.studentName,callback:function(t){e.$set(e.searchForm,"studentName",t)},expression:"searchForm.studentName"}})],1),o("el-form-item",{attrs:{label:"学号",prop:"studentId"}},[o("el-input",{attrs:{placeholder:"请输入学号",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.searchForm.studentId,callback:function(t){e.$set(e.searchForm,"studentId",t)},expression:"searchForm.studentId"}})],1),o("el-form-item",{staticClass:"search-item",attrs:{label:"课程名",prop:"courseName"}},[o("el-input",{attrs:{placeholder:"请输入课程名",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.searchForm.courseName,callback:function(t){e.$set(e.searchForm,"courseName",t)},expression:"searchForm.courseName"}})],1),o("el-form-item",{attrs:{label:"教师名",prop:"teacherName"}},[o("el-input",{attrs:{placeholder:"请输入教师名",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.searchForm.teacherName,callback:function(t){e.$set(e.searchForm,"teacherName",t)},expression:"searchForm.teacherName"}})],1),o("el-form-item",{attrs:{label:"分数",prop:"scoreCode"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.searchForm.scoreCode,callback:function(t){e.$set(e.searchForm,"scoreCode",t)},expression:"searchForm.scoreCode"}},e._l(e.scoreOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),o("el-form-item",{staticClass:"form_btn"},[o("el-button",{attrs:{type:"default"},on:{click:e.search}},[e._v("查询")]),o("el-button",{attrs:{type:"default"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")]),o("el-button",{attrs:{type:"text"},on:{click:function(t){e.formCollapse=!e.formCollapse}}},[e._v(" "+e._s(e.formCollapse?"查看更多":"收起")+" "),o("i",{class:[e.formCollapse?"el-icon-caret-bottom":"el-icon-caret-top"]})])],1)],1),o("template",{slot:"tableBtn"},[o("el-button",{attrs:{type:"primary",plain:"",size:"mini",disabled:e.exportDisabled},on:{click:function(t){return e.exportScore(!1)}}},[e._v("导出")]),o("qr-button",{attrs:{searchData:e.searchForm}}),o("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){return e.exportScore(!0)}}},[e._v("导出全部")])],1)],2)},r=[],l=(o("4160"),o("ac1f"),o("841c"),o("159b"),o("5530")),n=o("b893"),s=o("0680"),c=o("db5f"),u={name:"allCourses",data:function(){return{searchForm:{studentName:"",studentId:"",courseName:"",teacherName:"",scoreCode:""},scoreOptions:s["a"],ruleFormIndex:"ruleForm"+Math.ceil(100*Math.random()),tableData:[],totalCount:0,selectedCourseId:"",page:1,count:10,tableObj:{},exportDisabled:!0,multipleSelection:[],formCollapse:!1}},mounted:function(){this.tableObj=this.$refs["table"]},methods:{exportScore:function(e){var t=this,o=[];this.multipleSelection.forEach((function(e){return o.push(e.scoreId)})),this.loading(),this.axios.post("/exportStudentScores",Object(l["a"])(Object(l["a"])({scoreIds:o},this.searchForm),{},{all:e?1:0,page:this.page,count:this.count}),{responseType:"blob"}).then((function(e){Object(n["a"])(e.data,"学生成绩"),t.$message.success("导出成功"),t.loaded.close()}))},selectChange:function(e){this.multipleSelection=e,e.length>0&&(this.exportDisabled=!1)},getTable:function(e,t){this.page=e,this.count=t,this.getTableData.call(this,"/admins/allScores",this.searchForm)},updateScore:function(e){var t=this;this.$prompt("请输入分数","提示",{inputValue:e.score>-1?e.score:"",confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:function(e){if(!e)return"请输入分数";if("-1"!==e){if(!/^\d{1,3}(\.\d)?$/.test(e))return"格式不正确";if(e<0||e>100)return"分数超过限制"}}}).then((function(o){t.loading(),t.axios.post("/admins/updateScore",{score:o.value,studentId:e.studentId,courseId:e.courseId}).then((function(e){var o=e.data;t.loaded&&t.loaded.close(),0===o.status&&(t.$message.success(o.message),t.tableObj.refresh())}))}))},computeIndex:function(e){return(this.page-1)*this.count+e+1},resetForm:function(e){this.$refs[e].resetFields()},search:function(){this.tableObj.search()}},components:{qrButton:c["a"]}},i=u,p=o("2877"),d=Object(p["a"])(i,a,r,!1,null,null,null);t["default"]=d.exports},3770:function(e,t,o){},b893:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));o("d3b7"),o("3ca3"),o("ddb0"),o("2b3d");var a=function(e,t){var o=URL.createObjectURL(e),a=document.createElement("a");a.style.display="none",a.href=o;var l=new Date,n=l.getFullYear()+"-"+r(l.getMonth()+1)+"-"+r(l.getDate())+"_"+r(l.getHours())+r(l.getMinutes())+r(l.getSeconds());a.download=t+"-"+n+".xlsx",document.body.appendChild(a),a.click(),document.body.removeChild(a)};function r(e){return(e+"").length<2?"0"+e:e}},db5f:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-button",{ref:"qr_export",staticClass:"qr_export",attrs:{type:"primary",plain:"",size:"mini"}},[e._t("default",[e._v("导出全部至手机")])],2)},r=[],l=(o("d3b7"),o("3ca3"),o("ddb0"),o("2b3d"),o("5530")),n={name:"qrButton",props:["searchData"],mounted:function(){var e=this,t=document.createElement("img");t.classList.add("qr_img");var o,a,r=this.$refs["qr_export"].$el,n=!1,s=0,c=!1,u=!0;r.append(t),r.addEventListener("mouseover",(function(){if(u=!1,n)return clearTimeout(o);o=setTimeout((function(){!(Date.now()>s+6e5)&&a||c||(c=!0,e.axios.get("/qrExportScore",{params:Object(l["a"])({},e.searchData),responseType:"blob"}).then((function(e){c=!1,s=Date.now(),a=URL.createObjectURL(new Blob([e.data])),t.src=a}))),u||(t.alt="二维码加载失败",t.style.display="block",n=!0)}),200)})),r.addEventListener("mouseout",(function(){t.style.display="none",n=!1,u=!0}))}},s=n,c=(o("ecbf"),o("2877")),u=Object(c["a"])(s,a,r,!1,null,null,null);t["a"]=u.exports},ecbf:function(e,t,o){"use strict";var a=o("3770"),r=o.n(a);r.a}}]);
//# sourceMappingURL=chunk-626f0743.d106b947.js.map